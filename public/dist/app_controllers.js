app.controller("HomeController",["$rootScope","$scope","$location",function(t,o,e){var a=this;t.pageTitle="Healthy Fling",a.state="State",a.region="Region",a.category="Category",o.states=t.stateList,o.regions=t.regionList,o.regions&&-1==o.regions.indexOf("Region")&&o.regions.unshift("Region"),o.categories=t.categoryList,o.changeListInCtrl=function(e){t.regionList=t.masterList[e],console.log("list updated:"+e),o.regions=t.regionList,o.regions.unshift("Region")},console.log("Inside Home Controller"),a.post=function(){a.dataLoading=!0,console.log("asdasdsa"),e.path("/post")},a.search=function(){t.loading=!0,console.log(this.state),t.search.state=this.state,t.search.region=this.region,t.search.category=this.category,a.dataLoading=!0,console.log("asdasdsa"),e.path("/search")}}]),app.controller("PostController",["$rootScope","$scope","$location","HttpService","$window","FlashService",function(t,o,a,s,i,n){var r=this;t.pageTitle="Post an ad",o.states=t.stateList,o.regions=t.regionList,o.haircolors=t.haircolorList,o.heights=t.heightList,o.ethnicity=t.ethnicityList,o.orientation=t.orientationList,o.bodytype=t.bodytypeList,o.eyecolor=t.eyecolorList,o.status=t.statusList,o.gender=t.genderList,o.bodyhair=t.bodyHairList,o.hivstatus=t.hivstatusList,o.anonymouscomment=["enabled","disabled"],o.notified=["yes","no"];for(var e=["Age"],l=0;l<201;l++)e.push(l);o.ageRange=e,e=["Weight"];for(l=90;l<501;l++)e.push(l);o.weightRange=e,o.regions&&-1==o.regions.indexOf("Region")&&o.regions.unshift("Region"),o.categories=t.categoryList,r.state=t.search.state,r.region=t.search.region,r.category=t.search.category,t.imageList=[],o.changeListInCtrl=function(e){t.regionList=t.masterList[e],console.log("list updated:"+e),o.regions=t.regionList,o.regions.unshift("Region")},o.stopLoader=function(){t.loadingImage=!1},o.deleteImage=function(e){console.log("Deleted"),t.imageList.splice(e,1),r.data.files=t.imageList,console.log(t.imageList),console.log(r.data.files)},r.files=[],console.log("asd"),r.post=function(){a.path("/post")},r.check=function(){0<r.data.files.length&&alert(r.data.files.length+" files selected ... Max allowed files is 5.")},r.search=function(){t.search.state=this.state,t.search.region=this.region,t.search.category=this.category,console.log("asdasdsa"),a.path("/search")},r.data={title:"",state:"State",region:"Region",category:"Category",location:"",age:"",message:"",email:"",haircolor:"Hair Color",height:"Height",ethnicity:"Ethnicity",orientation:"Orientation",bodytype:"Body Type",eyecolor:"Eye Color",mstatus:"Status",gender:"Gender",bodyhair:"Body Hair",hivstatus:"HIV Status",anonymouscomment:"disabled",notified:"no",share:"disabled",embed:"",weight:"Weight",mage:"Age"},r.verifyemail="",r.addPost=function(){if(r.showImageError=!1,r.showRequiredStateError=!1,r.showRequiredRegionError=!1,r.showRequiredCategoryError=!1,r.showMessageError=!1,r.showTitleError=!1,r.showCaptchaError=!1,r.showMissingEmailError=!1,r.showEmailError=!1,r.showAgeError=!1,r.showError=!0,t.imageList&&5<t.imageList.length&&(r.showImageError=!0,r.imageLength=t.imageList.length),r.data.state&&"State"!=r.data.state||(r.showRequiredStateError=!0),r.data.region&&"Region"!=r.data.region||(r.showRequiredRegionError=!0),r.data.category&&"Category"!=r.data.category||(r.showRequiredCategoryError=!0),r.data.title||(r.showTitleError=!0),r.data.message||(r.showMessageError=!0),r.captcha||(r.showCaptchaError=!0),""==r.data.email&&(r.showMissingEmailError=!0),r.data.age&&isNaN(r.data.age)&&(r.showAgeError=!0),r.data.email!=r.verifyemail&&(r.showEmailError=!0),"Hair Color"==r.data.haircolor&&(r.data.haircolor=""),"Height"==r.data.height&&(r.data.height=""),"Ethnicity"==r.data.ethnicity&&(r.data.ethnicity=""),"Orientation"==r.data.orientation&&(r.data.orientation=""),"Body Type"==r.data.bodytype&&(r.data.bodytype=""),"Eye Color"==r.data.eyecolor&&(r.data.eyecolor=""),"Status"==r.data.mstatus&&(r.data.mstatus=""),"Gender"==r.data.gender&&(r.data.gender=""),"Body Hair"==r.data.bodyhair&&(r.data.bodyhair=""),"HIV Status"==r.data.hivstatus&&(r.data.hivstatus=""),"Age"==r.data.mage&&(r.data.mage=""),"Weight"==r.data.weight&&(r.data.weight=""),r.showRequiredStateError||r.showRequiredRegionError||r.showAgeError||r.showRequiredCategoryError||r.showMessageError||r.showCaptchaError||r.showImageError||r.showTitleError||r.showEmailError||r.showMissingEmailError)console.log("Validation Failed"),i.scrollTo(0,0),""==r.data.mage&&(r.data.mage="Age"),""==r.data.haircolor&&(r.data.haircolor="Hair Color"),""==r.data.height&&(r.data.height="Height"),""==r.data.ethnicity&&(r.data.ethnicity="Ethnicity"),""==r.data.orientation&&(r.data.orientation="Orientation"),""==r.data.bodytype&&(r.data.bodytype="Body Type"),""==r.data.eyecolor&&(r.data.eyecolor="Eye Color"),""==r.data.mstatus&&(r.data.mstatus="Status"),""==r.data.gender&&(r.data.gender="Gender"),""==r.data.bodyhair&&(r.data.bodyhair="Body Hair"),""==r.data.hivstatus&&(r.data.hivstatus="HIV Status"),""==r.data.weight&&(r.data.weight="Weight");else{r.showError=!1,r.showImageError=!1,t.loading=!0,console.log(r.data.files);var e={title:this.data.title,state:this.data.state,region:this.data.region,category:this.data.category,location:this.data.location,age:this.data.age,message:this.data.message,email:this.data.email,haircolor:this.data.haircolor,height:this.data.height,ethnicity:this.data.ethnicity,orientation:this.data.orientation,bodytype:this.data.bodytype,eyecolor:this.data.eyecolor,mstatus:this.data.mstatus,gender:this.data.gender,bodyhair:this.data.bodyhair,hivstatus:this.data.hivstatus,anonymouscomment:this.data.anonymouscomment,notified:this.data.notified,share:this.data.share,embed:this.data.embed.replace("src=","xxx=").replace("href=","yyyy="),weight:this.data.weight,mage:this.data.mage,files:t.imageList};s.AddPost(e).then(function(e){"200"==e.status?(console.log("success"),console.log(e),e&&e.data&&e.data._id?a.path("/confirm/"+e.data._id):e&&e.data&&"limit reached"==e.data.data&&(""==r.data.mage&&(r.data.mage="Age"),""==r.data.haircolor&&(r.data.haircolor="Hair Color"),""==r.data.height&&(r.data.height="Height"),""==r.data.ethnicity&&(r.data.ethnicity="Ethnicity"),""==r.data.orientation&&(r.data.orientation="Orientation"),""==r.data.bodytype&&(r.data.bodytype="Body Type"),""==r.data.eyecolor&&(r.data.eyecolor="Eye Color"),""==r.data.mstatus&&(r.data.mstatus="Status"),""==r.data.gender&&(r.data.gender="Gender"),""==r.data.bodyhair&&(r.data.bodyhair="Body Hair"),""==r.data.hivstatus&&(r.data.hivstatus="HIV Status"),""==r.data.weight&&(r.data.weight="Weight"),n.Error("Maximum Limit Reached: You have too many posts at one time. You can delete some posts or wait till your other posts expire!"),i.scrollTo(0,0)),t.loading=!1):(t.loading=!1,r.dataLoading=!1,a.path("/"))})}}}]),app.controller("SearchController",["$rootScope","$scope","$location","HttpService","$window",function(a,t,o,e,s){var i=this;a.pageTitle="Healthy Fling",t.states=a.stateList,t.regions=a.regionList,t.regions&&-1==t.regions.indexOf("Region")&&t.regions.unshift("Region"),t.categories=a.categoryList,t.changeListInCtrl=function(e){a.regionList=a.masterList[e],console.log("list updated:"+e),t.regions=a.regionList,t.regions.unshift("Region")},a.loading=!0,a.adPosts={},console.log("in SearchController");var n=o.search();console.log(n),i.currentPage=n.page||0,i.pageSize=100,i.state=a.search.state||"State",i.region=a.search.region||"Region",i.category=a.search.category||"Category",i.post=function(){o.path("/post")},i.search=function(){a.search.state=i.state,a.search.region=i.region,a.search.category=i.category,console.log("asdasdsa"),this.reloadSearch()},i.searchAll=function(){i.state="State",i.region="Region",i.category="Category",a.search.state=i.state,a.search.region=i.region,a.search.category=i.category,console.log("asdasdsa"),this.reloadSearch()},i.searchFilter=function(e,t,o){"State"==e&&"Region"==t?console.log("Do nothing"):(a.search.state=e,i.state=e,a.search.region=t,i.region=t,a.search.category=o,i.category=o,console.log("asdasdsa"),this.reloadSearch())},i.reloadSearch=function(){a.loading=!0,e.GetPosts().then(function(e){if(console.log(e),"200"==e.status){a.adPosts.data=[];for(var t=0;t<e.data.length;t++)a.adPosts.data.push(e.data[t]);console.log("success"),a.refreshAds(),a.loading=!1}else i.dataLoading=!1,o.path("/"),a.loading=!1})},i.nextPage=function(){i.currentPage=i.currentPage+1,console.log(i.currentPage),o.search("page",i.currentPage)},i.prevPage=function(){i.currentPage=i.currentPage-1,console.log(i.currentPage),o.search("page",i.currentPage)},t.initController=function(){console.log("loading...."),a.loading=!0,e.GetPosts().then(function(e){if(console.log(e),"200"==e.status){a.visitedSearchPage=!0,a.adPosts.data=[];for(var t=0;t<e.data.length;t++)a.adPosts.data.push(e.data[t]);console.log("success"),a.refreshAds(),a.loading=!1}else i.dataLoading=!1,o.path("/"),a.loading=!1})}}]),app.filter("startFrom",function(){return function(e,t){return t=+t,e?e.slice(t):0}}),app.filter("roundup",function(){return function(e){return Math.ceil(e)}}),app.controller("AdsController",["$scope","$rootScope","$location","HttpService",function(e,o,a,t){console.log("Inside AdsController ");var s={};s.state=o.search.state,s.region=o.search.region,s.category=o.search.category,o.loading=!0,o.currentPost={},o.viewDetail=function(e){console.log(e),o.currentPost.data=e,a.path("/detail/"+e._id)},o.refreshAds=function(){t.GetPosts().then(function(e){if(console.log(e),"200"==e.status){o.adPosts.data=[],"Region"!=o.search.region&&""!=o.search.region?o.pageTitle=o.search.region:o.pageTitle="All Regions";for(var t=0;t<e.data.length;t++)o.adPosts.data.push(e.data[t]);console.log("success"),o.loading=!1}else o.loading=!1,s.dataLoading=!1,a.path("/")}),e.data=o.adPosts.data.reverse()}}]),app.controller("ContactController",["$rootScope","$scope","$location","HttpService","$window","FlashService",function(t,o,e,a,s,i){var n=this;t.pageTitle="Contact us",o.states=t.stateList,o.regions=t.regionList,o.regions&&-1==o.regions.indexOf("Region")&&o.regions.unshift("Region"),o.categories=t.categoryList,o.changeListInCtrl=function(e){t.regionList=t.masterList[e],console.log("list updated:"+e),o.regions=t.regionList,o.regions.unshift("Region")},o.updateList=function(e){t.regionList=t.masterList[e],console.log("list updated:"+e),o.regions=t.regionList,o.regions.unshift("Region")},n.post=function(){e.path("/post")},n.search=function(){t.search.state=this.state,t.search.region=this.region,t.search.category=this.category,console.log("asdasdsa"),e.path("/search")},console.log("Inside Home Controller"),n.post=function(){n.dataLoading=!0,console.log("asdasdsa"),e.path("/post")},n.search=function(){n.dataLoading=!0,console.log("asdasdsa"),e.path("/search")},o.notify=function(){if(o.showError=!0,o.showRequiredNameError=!1,o.showRequiredEmailError=!1,o.showRequiredSubjectError=!1,o.showRequiredMessageError=!1,o.showCaptchaError=!1,o.name||(o.showRequiredNameError=!0),o.email||(o.showRequiredEmailError=!0),o.subject||(o.showRequiredSubjectError=!0),o.message||(o.showRequiredMessageError=!0),o.captcha||(o.showCaptchaError=!0),o.showCaptchaError||o.showRequiredNameError||o.showRequiredEmailError||o.showRequiredSubjectError||o.showRequiredMessageError)console.log("Validation Failed"),s.scrollTo(0,0);else{t.loading=!0;var e={message:"Equiry Log: \n\n Name: "+o.name+"\nEnquiry: "+o.message+"\nEmail: "+o.email+"\n\n Regards, \n\n"+o.name,subject:"Received Request: "+o.subject,sender1:"info@healthyfling.com",from:o.email};o.showError=!1,a.SendMail(e).then(function(e){console.log(e),"200"==e.status||"250"==e.status?(console.log("success"),t.loading=!1,i.Success("Your Contact submission went through, you will receive a response between 24 and 48 hours."),o.name="",o.message="",o.email="",o.subject="",o.captcha=""):(n.dataLoading=!1,t.loading=!1,i.Error("There was an error while submitting your request. Please try again."))})}}}]),app.controller("ConfirmController",["$rootScope","$scope","$location","HttpService","$http",function(o,a,s,i,n){var r=this;o.pageTitle="Healthy Fling",a.states=o.stateList,a.regions=o.regionList,a.regions&&-1==a.regions.indexOf("Region")&&a.regions.unshift("Region"),a.categories=o.categoryList,a.changeListInCtrl=function(e){o.regionList=o.masterList[e],console.log("list updated:"+e),a.regions=o.regionList,a.regions.unshift("Region")},a.updateList=function(e){o.regionList=o.masterList[e],console.log("list updated:"+e),a.regions=o.regionList,a.regions.unshift("Region")},r.post=function(){s.path("/post")},r.search=function(){o.search.state=this.state,o.search.region=this.region,o.search.category=this.category,console.log("asdasdsa"),s.path("/search")},console.log("Inside Home Controller"),r.post=function(){r.dataLoading=!0,console.log("asdasdsa"),s.path("/post")},r.search=function(){r.dataLoading=!0,console.log("asdasdsa"),s.path("/search")},a.initController=function(){n.get("/data.json").success(function(e){o.masterList=e});var e=s.path().split("/"),t=e[e.length-1];a.id=t,o.loading=!0,a.mainImage="https://placehold.it/710X420",i.GetAPost(t).then(function(e){console.log(e),"200"==e.status?(o.currentPost.data=e.data,o.regionList=o.masterList[e.data.state],a.regions=o.regionList,console.log("success"),r.state=e.data.state,r.region=e.data.region,r.category=e.data.category,a.id=o.currentPost.data._id,a.title=o.currentPost.data.title,o.pageTitle=a.title,a.message=o.currentPost.data.body,a.age=o.currentPost.data.age,a.location=o.currentPost.data.location,a.region=o.currentPost.data.region,a.sender1=o.currentPost.data.email,a.state=o.currentPost.data.state,a.category=o.currentPost.data.category,a.created=o.currentPost.data.created,a.files=o.currentPost.data.files,o.loading=!1,0<a.files.length&&(a.mainImage=a.files[0].url)):(o.loading=!1,r.dataLoading=!1,s.path("/"))})},a.notify=function(){if(a.captcha)if(a.email){o.loading=!0;var e={htmlmessage:"<p>"+a.replymessage+"</p><p>"+s.absUrl().replace("reply","detail")+"</p><p><a href='mailto:"+a.email+"?subject=Re: "+a.title+"'>Reply to this message</a> </p> Regards, <br/>Healthyfling Team",subject:"Re: "+(a.title||a.message),sender1:a.sender1};console.log(e),i.SendMail(e).then(function(e){console.log(e),"200"==e.success||"250"==e.success?(console.log("success"),o.loading=!1,alert("Email has been sent to the poster!")):(r.dataLoading=!1,o.loading=!1,alert("Email has been sent to the poster!"),s.path("/"))})}else alert("Email address is missing");else alert("Please accept the terms and condition.")}}]),app.controller("ResponseController",["$rootScope","$scope","$location","HttpService","$http",function(t,o,e,a,s){var i=this;t.pageTitle="Healthy Fling",o.states=t.stateList,o.regions=t.regionList,o.regions&&-1==o.regions.indexOf("Region")&&o.regions.unshift("Region"),o.categories=t.categoryList,o.changeListInCtrl=function(e){t.regionList=t.masterList[e],console.log("list updated:"+e),o.regions=t.regionList,o.regions.unshift("Region")},o.updateList=function(e){t.regionList=t.masterList[e],console.log("list updated:"+e),o.regions=t.regionList,o.regions.unshift("Region")},i.post=function(){e.path("/post")},i.search=function(){t.search.state=this.state,t.search.region=this.region,t.search.category=this.category,console.log("asdasdsa"),e.path("/search")},console.log("Inside Home Controller"),i.post=function(){i.dataLoading=!0,console.log("asdasdsa"),e.path("/post")},i.search=function(){i.dataLoading=!0,console.log("asdasdsa"),e.path("/search")}}]),app.controller("DeleteController",["$rootScope","$scope","$location","HttpService","$http",function(o,a,s,i,n){var r=this;o.pageTitle="Healthy Fling",a.states=o.stateList,a.regions=o.regionList,a.regions&&-1==a.regions.indexOf("Region")&&a.regions.unshift("Region"),a.categories=o.categoryList,a.changeListInCtrl=function(e){o.regionList=o.masterList[e],console.log("list updated:"+e),a.regions=o.regionList,a.regions.unshift("Region")},a.updateList=function(e){o.regionList=o.masterList[e],console.log("list updated:"+e),a.regions=o.regionList,a.regions.unshift("Region")},r.post=function(){s.path("/post")},r.search=function(){o.search.state=this.state,o.search.region=this.region,o.search.category=this.category,console.log("asdasdsa"),s.path("/search")},console.log("Inside Home Controller"),r.post=function(){r.dataLoading=!0,console.log("asdasdsa"),s.path("/post")},r.search=function(){r.dataLoading=!0,console.log("asdasdsa"),s.path("/search")},a.initController=function(){n.get("/data.json").success(function(e){o.masterList=e});var e=s.path().split("/"),t=e[e.length-1];a.id=t,o.loading=!0,a.mainImage="https://placehold.it/710X420",i.DeleteAPost(t).then(function(e){console.log(e),"200"==e.status?(o.currentPost.data=e.data,o.regionList=o.masterList[e.data.state],a.regions=o.regionList,console.log("success"),r.state=e.data.state,r.region=e.data.region,r.category=e.data.category,a.id=o.currentPost.data._id,a.title=o.currentPost.data.title,o.pageTitle=a.title,a.message=o.currentPost.data.body,a.age=o.currentPost.data.age,a.location=o.currentPost.data.location,a.region=o.currentPost.data.region,a.sender1=o.currentPost.data.email,a.state=o.currentPost.data.state,a.category=o.currentPost.data.category,a.created=o.currentPost.data.created,a.files=o.currentPost.data.files,o.loading=!1,0<a.files.length&&(a.mainImage=a.files[0].url)):(o.loading=!1,r.dataLoading=!1,s.path("/"))})},a.notify=function(){if(a.captcha)if(a.email){o.loading=!0;var e={htmlmessage:"<p>"+a.replymessage+"</p><p>"+s.absUrl().replace("reply","detail")+"</p><p><a href='mailto:"+a.email+"?subject=Re: "+a.title+"'>Reply to this message</a> </p> Regards, <br/>Healthyfling Team",subject:"Re: "+(a.title||a.message),sender1:a.sender1};console.log(e),i.SendMail(e).then(function(e){console.log(e),"200"==e.success||"250"==e.success?(console.log("success"),o.loading=!1,alert("Email has been sent to the poster!")):(r.dataLoading=!1,o.loading=!1,alert("Email has been sent to the poster!"),s.path("/"))})}else alert("Email address is missing");else alert("Please accept the terms and condition.")}}]),app.controller("DetailController",["$rootScope","$scope","$location","HttpService","$http","$route","FlashService",function(a,o,s,i,n,e,r){var l=this;a.visitedSearchPage&&(a.loading=!0),o.states=a.stateList,o.regions=a.regionList||["REGION"],o.regions&&-1==o.regions.indexOf("Region")&&o.regions.unshift("Region"),o.categories=a.categoryList,o.changeListInCtrl=function(e){a.regionList=a.masterList[e],console.log("list updated:"+e),o.regions=a.regionList,o.regions.unshift("Region")},o.changeMainImage=function(e){o.mainImage=e.secure_url},l.state=a.search.state,l.region=a.search.region,l.category=a.search.category;var t=s.path().split("/"),c=t[t.length-1];o.id=c,l.logout=function(){s.path("/login")},l.login=function(){s.path("/login")},l.dashboard=function(){s.path("/")},l.search=function(){a.loading=!0,console.log(this.state),a.search.status="",a.search.state=this.state,a.search.region=this.region,a.search.category=this.category,l.dataLoading=!0,console.log("asdasdsa"),s.path("/search")},l.flagged_search=function(){a.loading=!0,console.log(this.state),a.search.status="flagged",a.search.state=this.state,a.search.region=this.region,a.search.category=this.category,l.dataLoading=!0,console.log("asdasdsa"),s.path("/search")},o.initController=function(){n.get("/data.json").success(function(e){a.masterList=e}),l.state=a.search.state,l.region=a.search.region,l.category=a.search.category;var e=s.path().split("/"),t=e[e.length-1];o.id=t,a.visitedSearchPage&&(a.loading=!0),o.mainImage="https://placehold.it/710X420",i.GetAPost(t).then(function(e){if(console.log(e),"200"==e.status&&e.data._id){a.currentPost.data=e.data;var t=s.search();t&&"true"==t.success&&r.Success("Your post is now Live."),a.regionList=a.masterList[e.data.state],o.regions=a.regionList,console.log("success"),l.state=e.data.state,l.region=e.data.region,l.category=e.data.category,o.title=a.currentPost.data.title,a.pageTitle=o.title,o.post_id=a.currentPost.data._id,o.message=a.currentPost.data.body,o.age=a.currentPost.data.age,o.region=a.currentPost.data.region,o.location=a.currentPost.data.location,o.sender1=a.currentPost.data.email,o.state=a.currentPost.data.state,o.status=a.currentPost.data.status,o.category=a.currentPost.data.category,o.created=a.currentPost.data.created,o.files=a.currentPost.data.files,a.loading=!1,0<o.files.length&&(o.mainImage=o.files[0].secure_url)}else a.loading=!1,l.dataLoading=!1,s.path("/search")})},a.reloadPost=function(){l.state=a.currentPost.data.body},l.post=function(){s.path("/post")},l.search=function(){a.loading=!0,a.search.state=this.state,a.search.region=this.region,a.search.category=this.category,console.log("asdasdsa"),s.path("/search")},l.searchFilter=function(e,t,o){"State"==e&&"Region"==t?console.log("Do nothing"):(a.loading=!0,a.search.state=e,a.search.region=t,a.search.category=o,console.log("asdasdsa"),s.path("/search"))},o.notify=function(){if(o.showEmail=!0,console.log("mail sent"),o.showEmail&&o.sender2&&0<o.sender2.length){a.loading=!0;var e={message:"Perfect match found for both of you.",subject:"We need to put in a subject",sender1:o.sender1,sender2:o.sender2,link:s.$$absUrl};i.SendMail(e).then(function(e){console.log(e),"200"==e.success||"250"==e.success?(console.log("success"),a.loading=!1,alert("Email has been sent to the poster!")):(l.dataLoading=!1,a.loading=!1,alert("Email has been sent to the poster!"),s.path("/"))})}}}]),app.controller("ExpiredController",["$rootScope","$scope","$location","HttpService","$http",function(t,o,e,a,s){var i=this;t.pageTitle="Healthy Fling",o.states=t.stateList,o.regions=t.regionList,o.regions&&-1==o.regions.indexOf("Region")&&o.regions.unshift("Region"),o.categories=t.categoryList,o.changeListInCtrl=function(e){t.regionList=t.masterList[e],console.log("list updated:"+e),o.regions=t.regionList,o.regions.unshift("Region")},o.updateList=function(e){t.regionList=t.masterList[e],console.log("list updated:"+e),o.regions=t.regionList,o.regions.unshift("Region")},i.post=function(){e.path("/post")},i.search=function(){t.search.state=this.state,t.search.region=this.region,t.search.category=this.category,console.log("asdasdsa"),e.path("/search")},console.log("Inside Home Controller"),i.post=function(){i.dataLoading=!0,console.log("asdasdsa"),e.path("/post")},i.search=function(){i.dataLoading=!0,console.log("asdasdsa"),e.path("/search")}}]),app.controller("ErrorController",["$rootScope","$scope","$location","HttpService","$http",function(t,o,e,a,s){var i=this;t.pageTitle="Healthy Fling",o.states=t.stateList,o.regions=t.regionList,o.regions&&-1==o.regions.indexOf("Region")&&o.regions.unshift("Region"),o.categories=t.categoryList,o.changeListInCtrl=function(e){t.regionList=t.masterList[e],console.log("list updated:"+e),o.regions=t.regionList,o.regions.unshift("Region")},o.updateList=function(e){t.regionList=t.masterList[e],console.log("list updated:"+e),o.regions=t.regionList,o.regions.unshift("Region")},i.post=function(){e.path("/post")},i.search=function(){t.search.state=this.state,t.search.region=this.region,t.search.category=this.category,console.log("asdasdsa"),e.path("/search")},console.log("Inside Home Controller"),i.post=function(){i.dataLoading=!0,console.log("asdasdsa"),e.path("/post")},i.search=function(){i.dataLoading=!0,console.log("asdasdsa"),e.path("/search")}}]),app.controller("ReplyController",["$rootScope","$scope","$location","HttpService","$http","$window","FlashService","$modal",function(o,a,s,i,n,r,l,e){var c=this;a.states=o.stateList,a.regions=o.regionList,a.regions&&-1==a.regions.indexOf("Region")&&a.regions.unshift("Region"),a.categories=o.categoryList,a.changeListInCtrl=function(e){o.regionList=o.masterList[e],console.log("list updated:"+e),a.regions=o.regionList,a.regions.unshift("Region")},a.updateList=function(e){o.regionList=o.masterList[e],console.log("list updated:"+e),a.regions=o.regionList,a.regions.unshift("Region")},o.tempImageList=[],a.replyfiles=[],a.stopLoader=function(){o.loadingImage=!1},a.deleteImage=function(e){console.log("Deleted"),o.tempImageList.splice(e,1),a.replyfiles=o.tempImageList,console.log(o.tempImageList),console.log(a.replyfiles)},c.post=function(){s.path("/post")},c.search=function(){o.search.state=this.state,o.search.region=this.region,o.search.category=this.category,console.log("asdasdsa"),s.path("/search")},console.log("Inside Home Controller"),c.post=function(){c.dataLoading=!0,console.log("asdasdsa"),s.path("/post")},c.search=function(){c.dataLoading=!0,console.log("asdasdsa"),s.path("/search")},a.initController=function(){n.get("/data.json").success(function(e){o.masterList=e});var e=s.path().split("/"),t=e[e.length-1];a.id=t,a.mainImage="https://placehold.it/710X420",i.GetAPost(t).then(function(e){console.log(e),"200"==e.status?(o.currentPost.data=e.data,o.regionList=o.masterList[e.data.state],a.regions=o.regionList,console.log("success"),c.state=e.data.state,c.region=e.data.region,c.category=e.data.category,a.id=o.currentPost.data._id,a.title=o.currentPost.data.title,o.pageTitle=a.title,a.message=o.currentPost.data.body,a.age=o.currentPost.data.age,a.location=o.currentPost.data.location,a.region=o.currentPost.data.region,a.sender1=o.currentPost.data.email,a.state=o.currentPost.data.state,a.category=o.currentPost.data.category,a.created=o.currentPost.data.created,a.files=o.currentPost.data.files,o.loading=!1,0<a.files.length&&(a.mainImage=a.files[0].secure_url)):(o.loading=!1,c.dataLoading=!1,s.path("/"))})},a.notify=function(){if(a.imageLength=0,a.showError=!0,a.showRequiredEmailError=!1,a.showRequiredReplyMessageError=!1,a.showEmailError=!1,a.showImageError=!1,a.showCaptchaError=!1,o.tempImageList&&5<o.tempImageList.length&&(a.showImageError=!0,a.imageLength=o.tempImageList.length),a.email||(a.showRequiredEmailError=!0),a.replymessage||(a.showRequiredReplyMessageError=!0),a.captcha||(a.showCaptchaError=!0),a.email!=a.confirmemail&&(a.showEmailError=!0),a.showCaptchaError||a.showRequiredEmailError||a.showRequiredReplyMessageError||a.showEmailError)console.log("Validation Failed"),r.scrollTo(0,0);else{a.closeModal(),l.Success("You have successfully replied to this post, you may or may not get a response from this poster.");var e=new Date,t={htmlmessage:"<p>"+a.replymessage+"</p><p>Original Post:</p><p>"+s.absUrl().replace("reply","detail")+"</p> Regards, <br/>Healthyfling Team",subject:"[HealthyFling] RE: "+(a.title||a.message)+" - "+e.toLocaleString("en-US",{timeZone:"America/New_York"})+" ET",sender1:a.sender1,attachments:o.tempImageList,"x-from":a.email,"x-post-id":a.id};console.log(t),a.showError=!1,i.SendMail(t).then(function(e){console.log(e),"200"==e.status||"250"==e.status?(console.log("success"),o.loading=!1,o.loading=!1):(c.dataLoading=!1,o.loading=!1,l.Error("There was an error while submitting your request. Please try again."))})}},a.closeModal=function(){console.log("closing modal"),o.modalInstance.close()}}]),app.controller("CommentController",["$rootScope","$scope","$location","HttpService","$http","$window","FlashService","$modal",function(o,a,s,i,n,t,r,e){var l=this;a.states=o.stateList,a.regions=o.regionList,a.regions&&-1==a.regions.indexOf("Region")&&a.regions.unshift("Region"),a.categories=o.categoryList,a.changeListInCtrl=function(e){o.regionList=o.masterList[e],console.log("list updated:"+e),a.regions=o.regionList,a.regions.unshift("Region")},a.updateList=function(e){o.regionList=o.masterList[e],console.log("list updated:"+e),a.regions=o.regionList,a.regions.unshift("Region")},o.tempImageList=[],a.replyfiles=[],a.stopLoader=function(){o.loadingImage=!1},a.deleteImage=function(e){console.log("Deleted"),o.tempImageList.splice(e,1),a.replyfiles=o.tempImageList,console.log(o.tempImageList),console.log(a.replyfiles)},l.post=function(){s.path("/post")},l.search=function(){o.search.state=this.state,o.search.region=this.region,o.search.category=this.category,console.log("asdasdsa"),s.path("/search")},console.log("Inside Home Controller"),l.post=function(){l.dataLoading=!0,console.log("asdasdsa"),s.path("/post")},l.search=function(){l.dataLoading=!0,console.log("asdasdsa"),s.path("/search")},a.initController=function(){console.log(o.comment),a.commentMessage=o.comment.body,a.commentId=o.comment._id,n.get("/data.json").success(function(e){o.masterList=e});var e=s.path().split("/"),t=e[e.length-1];a.id=t,a.mainImage="https://placehold.it/710X420",i.GetAPost(t).then(function(e){console.log(e),"200"==e.status?(o.currentPost.data=e.data,o.regionList=o.masterList[e.data.state],a.regions=o.regionList,console.log("success"),l.state=e.data.state,l.region=e.data.region,l.category=e.data.category,a.id=o.currentPost.data._id,a.title=o.currentPost.data.title,o.pageTitle=a.title,a.message=o.currentPost.data.body,a.age=o.currentPost.data.age,a.location=o.currentPost.data.location,a.region=o.currentPost.data.region,a.sender1=o.currentPost.data.email,a.state=o.currentPost.data.state,a.category=o.currentPost.data.category,a.created=o.currentPost.data.created,a.files=o.currentPost.data.files,o.loading=!1,0<a.files.length&&(a.mainImage=a.files[0].secure_url)):(o.loading=!1,l.dataLoading=!1,s.path("/"))})},a.notify=function(){if(a.imageLength=0,a.showError=!0,a.showRequiredReplyMessageError=!1,a.showCaptchaError=!1,a.replymessage||(a.showRequiredReplyMessageError=!0),a.captcha||(a.showCaptchaError=!0),a.showCaptchaError||a.showRequiredReplyMessageError)console.log("Validation Failed"),t.scrollTo(0,0);else{a.closeModal(),r.Success("You have successfully replied to this comment!"),o.loading=!0;var e={commentmessage:a.replymessage};i.ReplyAComment(a.commentId,e).then(function(e){console.log(e),"200"==e.status?(r.Success("You have successfully replied to this comment!"),o.loading=!1,t.scrollTo(0,0),o.comment={},o.$broadcast("reloadComments")):(console.log("something went wrong"),o.loading=!1,o.comment={})})}},a.closeModal=function(){console.log("closing modal"),o.comment={},o.modalInstance.close()}}]),app.controller("EditController",["$rootScope","$scope","$location","HttpService","$http","$window",function(o,a,s,i,n,r){var l=this;o.pageTitle="Post an ad",a.states=o.stateList,a.regions=o.regionList,a.haircolorList=o.haircolorList,a.heightList=o.heightList,a.ethnicityList=o.ethnicityList,a.orientationList=o.orientationList,a.bodytypeList=o.bodytypeList,a.eyecolorList=o.eyecolorList,a.statusList=o.statusList,a.genderList=o.genderList,a.bodyHairList=o.bodyHairList,a.hivstatusList=o.hivstatusList,a.anonymouscommentList=["enabled","disabled"],a.notifiedList=["yes","no"];for(var e=["Age"],t=0;t<201;t++)e.push(t);a.ageRange=e,e=["Weight"];for(t=90;t<501;t++)e.push(t);a.weightRange=e,a.regions&&-1==a.regions.indexOf("Region")&&a.regions.unshift("Region"),a.categories=o.categoryList,l.state=o.search.state,l.region=o.search.region,l.category=o.search.category,o.imageList=[],a.changeListInCtrl=function(e){o.regionList=o.masterList[e],console.log("list updated:"+e),a.regions=o.regionList,a.regions.unshift("Region")},a.stopLoader=function(){o.loadingImage=!1},a.deleteImage=function(e){console.log("Deleted"),o.imageList.splice(e,1),a.files=o.imageList,console.log(o.imageList),console.log(a.files)},l.files=[],console.log("asd"),l.post=function(){s.path("/post")},l.check=function(){0<l.data.files.length&&alert(l.data.files.length+" files selected ... Max allowed files is 5.")},l.search=function(){o.search.state=this.state,o.search.region=this.region,o.search.category=this.category,console.log("asdasdsa"),s.path("/search")},l.data={title:"",state:"State",region:"Region",category:"Category",location:"",age:"",message:"",email:"",haircolor:"Hair Color",height:"Height",ethnicity:"Ethnicity",orientation:"Orientation",bodytype:"Body Type",eyecolor:"Eye Color",status:"Status",gender:"Gender",bodyhair:"Body Hair",hivstatus:"HIV Status",anonymouscomment:"disabled",notified:"no",share:"disabled",embed:"",weight:"Weight",mage:"Age"},l.verifyemail="",a.editPost=function(e){if(console.log("edit clicked"),a.showImageError=!1,a.showRequiredStateError=!1,a.showRequiredRegionError=!1,a.showRequiredCategoryError=!1,a.showMessageError=!1,a.showTitleError=!1,a.showCaptchaError=!1,a.showMissingEmailError=!1,a.showEmailError=!1,a.showError=!0,o.imageList&&5<o.imageList.length&&(a.showImageError=!0,a.imageLength=o.imageList.length),a.state&&"State"!=a.state||(a.showRequiredStateError=!0),a.region&&"Region"!=a.region||(a.showRequiredRegionError=!0),a.category&&"Category"!=a.category||(a.showRequiredCategoryError=!0),a.title||(a.showTitleError=!0),a.message||(a.showMessageError=!0),a.captcha||(a.showCaptchaError=!0),"Hair Color"==a.haircolor&&(a.haircolor=""),"Height"==a.height&&(a.height=""),"Ethnicity"==a.ethnicity&&(a.ethnicity=""),"Orientation"==a.orientation&&(a.orientation=""),"Body Type"==a.bodytype&&(a.bodytype=""),"Eye Color"==a.eyecolor&&(a.eyecolor=""),"Status"==a.mstatus&&(a.mstatus=""),"Gender"==a.gender&&(a.gender=""),"Body Hair"==a.bodyhair&&(a.bodyhair=""),"HIV Status"==a.hivstatus&&(a.hivstatus=""),"Weight"==a.weight&&(a.weight=""),"Age"==a.mage&&(a.mage=""),a.showRequiredStateError||a.showRequiredRegionError||a.showRequiredCategoryError||a.showMessageError||a.showCaptchaError||a.showImageError||a.showTitleError)console.log("Validation Failed"),r.scrollTo(0,0);else{a.showImageError=!1,o.loading=!0;var t={title:a.title,state:a.state,region:a.region,category:a.category,location:a.location,age:a.age,message:a.message,haircolor:a.haircolor,height:a.height,ethnicity:a.ethnicity,orientation:a.orientation,bodytype:a.bodytype,eyecolor:a.eyecolor,mstatus:a.mstatus,gender:a.gender,bodyhair:a.bodyhair,hivstatus:a.hivstatus,anonymouscomment:a.anonymouscomment,notified:a.notified,embed:a.embed.replace("src=","xxx=").replace("href=","yyyy="),share:a.share,weight:a.weight,mage:a.mage,files:o.imageList};console.log(t),i.EditPost(e,t).then(function(e){"200"==e.status?(console.log("success"),console.log(e),e&&e.data&&e.data._id&&s.path("/detail/"+e.data._id),o.loading=!1):(o.loading=!1,l.dataLoading=!1,s.path("/"))})}},l.detail=function(e){s.path("/detail/"+e)},a.initController=function(){console.log("You r here"),n.get("/data.json").success(function(e){o.masterList=e});var e=s.path().split("/"),t=e[e.length-1];a.id=t,o.loading=!0,a.mainImage="https://placehold.it/710X420",i.GetAPost(t).then(function(e){console.log(e),"200"==e.status?(o.currentPost.data=e.data,o.regionList=o.masterList[e.data.state],a.regions=o.regionList,console.log("success"),l.state=e.data.state,l.region=e.data.region,l.category=e.data.category,a.id=o.currentPost.data._id,a.title=o.currentPost.data.title,o.pageTitle=a.title,a.message=o.currentPost.data.body,a.age=o.currentPost.data.age,a.location=o.currentPost.data.location,a.region=o.currentPost.data.region,a.sender1=o.currentPost.data.email,a.state=o.currentPost.data.state,a.category=o.currentPost.data.category,a.created=o.currentPost.data.created,a.files=o.currentPost.data.files,o.imageList=o.currentPost.data.files,a.haircolor=o.currentPost.data.haircolor||"Hair Color",a.height=o.currentPost.data.height||"Height",a.ethnicity=o.currentPost.data.ethnicity||"Ethnicity",a.orientation=o.currentPost.data.orientation||"Orientation",a.bodytype=o.currentPost.data.bodytype||"Body Type",a.eyecolor=o.currentPost.data.eyecolor||"Eye Color",a.mstatus=o.currentPost.data.mstatus||"Status",a.gender=o.currentPost.data.gender||"Gender",a.bodyhair=o.currentPost.data.bodyhair||"Body Hair",a.hivstatus=o.currentPost.data.hivstatus||"HIV Status",a.weight=o.currentPost.data.weight||"Weight",a.mage=o.currentPost.data.mage||"Age",a.anonymouscomment=o.currentPost.data.anonymouscomment||"disabled",a.notified=o.currentPost.data.notified||"no",a.share=o.currentPost.data.share||"disabled",a.embed=o.currentPost.data.embed.replace("xxx=","src=").replace("yyyy=","href=")||"",o.loading=!1,0<a.files.length&&(a.mainImage=a.files[0].secure_url)):(o.loading=!1,l.dataLoading=!1,s.path("/"))})}}]),app.controller("FlagController",["$rootScope","$scope","$location","HttpService","$http","FlashService","$window",function(a,s,i,n,e,r,l){var c=this;a.pageTitle="Healthy Fling",s.states=a.stateList,s.regions=a.regionList,s.regions&&-1==s.regions.indexOf("Region")&&s.regions.unshift("Region"),s.categories=a.categoryList,s.selection=[],s.toggleSelection=function(e,t){var o=t.indexOf(e);-1<o?t.splice(o,1):t.push(e)},s.changeListInCtrl=function(e){a.regionList=a.masterList[e],console.log("list updated:"+e),s.regions=a.regionList,s.regions.unshift("Region")},s.updateList=function(e){a.regionList=a.masterList[e],console.log("list updated:"+e),s.regions=a.regionList,s.regions.unshift("Region")},c.post=function(){i.path("/post")},c.search=function(){a.search.state=this.state,a.search.region=this.region,a.search.category=this.category,console.log("asdasdsa"),i.path("/search")},console.log("Inside Home Controller"),c.post=function(){c.dataLoading=!0,console.log("asdasdsa"),i.path("/post")},c.search=function(){c.dataLoading=!0,console.log("asdasdsa"),i.path("/search")},s.initController=function(){e.get("/data.json").success(function(e){a.masterList=e})},s.flagPost=function(){s.showError=!0,s.showReasonError=!1,s.selection.length<1&&(s.showReasonError=!0);var e=i.path().split("/"),t=e[e.length-1];if(s.id=t,a.loading=!0,s.mainImage="https://placehold.it/710X420",s.showReasonError)console.log("Validation Failed"),l.scrollTo(0,0);else{s.showError=!1,s.closeModal();var o={flagreason:s.selection};n.FlagPostReason(t,o).then(function(e){"200"==e.status?(console.log("success"),console.log(e),e&&e.data&&e.data._id&&(r.Success("An email has been sent to the poster saying that the post is flagged and will be removed from healthyflings listing."),a.is_flagged=!0),a.loading=!1):(a.loading=!1,r.Error("There was an error while submitting your request. Please try again."),c.dataLoading=!1)})}},s.notify=function(){if(s.captcha)if(s.email){a.loading=!0;var e={htmlmessage:"<p>"+s.replymessage+"</p><p>"+i.absUrl().replace("reply","detail")+"</p><p><a href='mailto:"+s.email+"?subject=Re: "+s.title+"'>Reply to this message</a> </p> Regards, <br/>Healthyfling Team",subject:"Re: "+(s.title||s.message),sender1:s.sender1};console.log(e),n.SendMail(e).then(function(e){console.log(e),"200"==e.success||"250"==e.success?(console.log("success"),a.loading=!1,alert("Email has been sent to the poster!")):(c.dataLoading=!1,a.loading=!1,alert("Email has been sent to the poster!"),i.path("/"))})}else alert("Email address is missing");else alert("Please accept the terms and condition.")},s.closeModal=function(){console.log("closing modal"),a.modalInstance.close()}}]),app.controller("DetailController",["$rootScope","$scope","$location","HttpService","$http","$route","FlashService","$document","$modal","$window",function(a,s,i,o,n,e,r,t,l,c){var g=this;a.visitedSearchPage&&(a.loading=!0),s.replyNotified=!1,s.showShareButtons=!1,s.showEmbedButtons=!1,s.replyNotifiedEmail="",s.currentPath=i.absUrl().replace("#/detail","api/render"),s.embed="",s.commentembed="",s.comments=[],s.commentsMainImage=[],s.states=a.stateList,s.regions=a.regionList||["REGION"],s.regions&&-1==s.regions.indexOf("Region")&&s.regions.unshift("Region"),s.categories=a.categoryList,s.changeListInCtrl=function(e){a.regionList=a.masterList[e],console.log("list updated:"+e),s.regions=a.regionList,s.regions.unshift("Region")},a.imageList=[],s.addComment=function(e){if(console.log("AddComment clicked"),s.showError=!0,"Age"==s.mage&&(s.mage=""),null==s.commentmessage&&""==s.commentmessage||null==s.captcha)console.log("Validation Failed"),r.Error("Please select the Capcha!"),c.scrollTo(0,0);else{s.showImageError=!1,a.loading=!0;var t={commentmessage:s.commentmessage,email:s.replyNotifiedEmail,commentfiles:a.imageList,commentembed:s.commentembed.replace("src=","xxx=").replace("href=","yyyy=")};console.log(t),o.EditPost(e,t).then(function(e){"200"==e.status?(console.log("success"),console.log(e),e&&e.data&&e.data._id&&(i.path("/detail/"+e.data._id),r.Success("Your comment has been successfully added."),s.loadComments(s.id),s.commentmessage="",s.commentembed="",c.scrollTo(0,0)),a.loading=!1,a.imageList=[],s.commentsMainImage=[],s.comments=[]):(a.loading=!1,g.dataLoading=!1,i.path("/"))})}},s.replyComment=function(e){console.log("ReplyComment clicked")},s.changeMainImage=function(e,t){s.mainImage=0==t?e.secure_url:e},s.changeCommentsMainImage=function(e,t){s.commentsMainImage[t]=e},g.state=a.search.state,g.region=a.search.region,g.category=a.search.category;var d=i.path().split("/"),h=d[d.length-1];s.id=h,s.loadComments=function(e){s.commentsMainImage=[],s.comments=[],o.GetComments(e).then(function(e){if(console.log(e),"200"==e.status)for(var t=0;t<e.data.length;t++){var o=e.data[t];o.embed&&(o.embed=o.embed.replace("xxx=","src=").replace("yyyy=","href=")),null!=o&&0<o.files.length?o.mainImage=o.files[0].secure_url:null!=o&&""!=o.embed&&0==o.files.length&&(o.mainImage=o.embed),console.log(o),s.commentsMainImage.push(o.mainImage),s.comments.push(o)}else console.log("something went wrong")})},s.deleteComment=function(e){a.loading=!0,o.DeleteAComment(e).then(function(e){console.log(e),"200"==e.status?(s.loadComments(s.id),r.Success("The comment has been successfully deleted."),a.loading=!1,c.scrollTo(0,0)):(console.log("something went wrong"),a.loading=!1)})},s.deleteReply=function(e){a.loading=!0,o.DeleteAReply(e).then(function(e){console.log(e),"200"==e.status?(s.loadComments(s.id),r.Success("The reply has been successfully deleted."),a.loading=!1,c.scrollTo(0,0)):(console.log("something went wrong"),a.loading=!1)})},s.flagComment=function(e){console.log("The comment has been flagged"),a.loading=!0,o.FlagAComment(e).then(function(e){console.log(e),"200"==e.status?(s.loadComments(s.id),r.Success("The comment has been successfully flagged."),a.loading=!1,c.scrollTo(0,0)):(console.log("something went wrong"),a.loading=!1)})},s.unflagComment=function(e){console.log("The comment has been flagged"),a.loading=!0,o.UnflagAComment(e).then(function(e){console.log(e),"200"==e.status?(s.loadComments(s.id),r.Success("The comment has been successfully unflagged."),a.loading=!1,c.scrollTo(0,0)):(console.log("something went wrong"),a.loading=!1)})},s.initController=function(){n.get("/data.json").success(function(e){a.masterList=e}),a.is_flagged=!1,g.state=a.search.state,g.region=a.search.region,g.category=a.search.category,s.comments=[];var e=i.path().split("/"),t=e[e.length-1];s.id=t,a.visitedSearchPage&&(a.loading=!0),s.mainImage="https://placehold.it/710X420",o.GetAPost(t).then(function(e){if(console.log(e),s.is_edit=!1,"200"==e.status&&e.data._id){a.currentPost.data=e.data;var t=i.search();t&&"true"==t.success?r.Success("Your post is now Live."):t&&"true"==t.edit?s.is_edit=!0:-1<i.url().indexOf("msg=true")&&r.Success("You have successfully replied to this post, you may or may not get a response from this poster."),a.regionList=a.masterList[e.data.state],s.regions=a.regionList,console.log("success"),g.state=e.data.state,g.region=e.data.region,g.category=e.data.category,s.title=a.currentPost.data.title,a.pageTitle=s.title,s.post_id=a.currentPost.data._id,s.message=a.currentPost.data.body,s.message=s.message.replace(/[\r\n]/g,"<br/>"),s.age=a.currentPost.data.age,s.region=a.currentPost.data.region,s.location=a.currentPost.data.location,s.sender1=a.currentPost.data.email,s.state=a.currentPost.data.state,s.category=a.currentPost.data.category,s.created=a.currentPost.data.created,s.expires=new Date(a.currentPost.data.created),s.expires.setDate(s.expires.getDate()+8),s.files=a.currentPost.data.files,s.haircolor=a.currentPost.data.haircolo,s.height=a.currentPost.data.height,s.ethnicity=a.currentPost.data.ethnicity,s.orientation=a.currentPost.data.orientation,s.bodytype=a.currentPost.data.bodytype,s.eyecolor=a.currentPost.data.eyecolor,s.mstatus=a.currentPost.data.mstatus,s.gender=a.currentPost.data.gender,s.bodyhair=a.currentPost.data.bodyhair,s.hivstatus=a.currentPost.data.hivstatus,s.weight=a.currentPost.data.weight,s.mage=a.currentPost.data.mage,s.anonymouscomment=a.currentPost.data.anonymouscomment||"disabled",s.embed=a.currentPost.data.embed.replace("xxx=","src=").replace("yyyy=","href=")||"",s.share=a.currentPost.data.share||"disabled",a.loading=!1,0<s.files.length?s.mainImage=s.files[0].secure_url:""!=s.embed&&0==s.files.length&&(s.mainImage=s.embed)}else a.loading=!1,g.dataLoading=!1,i.path("/expired")}),s.loadComments(t)},a.reloadPost=function(){g.state=a.currentPost.data.body},g.post=function(){i.path("/post")},g.search=function(){a.loading=!0,a.search.state=this.state,a.search.region=this.region,a.search.category=this.category,console.log("asdasdsa"),i.path("/search")},g.searchFilter=function(e,t,o){"State"==e&&"Region"==t?console.log("Do nothing"):(a.loading=!0,a.search.state=e,a.search.region=t,a.search.category=o,console.log("asdasdsa"),i.path("/search"))},s.notify=function(){if(s.showEmail=!0,console.log("mail sent"),s.showEmail&&s.sender2&&0<s.sender2.length){a.loading=!0;var e={message:"Perfect match found for both of you.",subject:"We need to put in a subject",sender1:s.sender1,sender2:s.sender2,link:i.$$absUrl};o.SendMail(e).then(function(e){console.log(e),"200"==e.success||"250"==e.success?(console.log("success"),a.loading=!1,alert("Email has been sent to the poster!")):(g.dataLoading=!1,a.loading=!1,alert("Email has been sent to the poster!"),i.path("/"))})}},s.toggleReplyNotify=function(){s.replyNotified&&1==s.replyNotified?(s.replyNotified=!1,s.replyNotifiedEmail=""):s.replyNotified=!0},s.toggleEmbedButton=function(){s.showEmbedButtons&&1==s.showEmbedButtons?s.showEmbedButtons=!1:s.showEmbedButtons=!0},s.toggleShareButton=function(){s.showShareButtons&&1==s.showShareButtons?s.showShareButtons=!1:s.showShareButtons=!0},s.openModal=function(){a.modalInstance=l.open({templateUrl:"app-view/reply/ReplyView.html"})},s.openModal_flag=function(){a.modalInstance=l.open({templateUrl:"app-view/flag/FlagView.html"})},s.openCommentModal=function(e){a.comment=e,a.modalInstance=l.open({templateUrl:"app-view/comment/CommentView.html"})},s.$on("reloadComments",function(){s.loadComments(s.id)}),s.deleteImage=function(e){console.log("Deleted"),a.imageList.splice(e,1),s.files=a.imageList,console.log(a.imageList),console.log(s.files)},s.stopLoader=function(){a.loadingImage=!1}}]);