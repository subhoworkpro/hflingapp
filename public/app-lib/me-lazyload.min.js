angular.module("me-lazyload",[]).directive("lazySrc",["$window","$document",function(e,t){var n=t[0],a=n.body,i=e,o=angular.element(i),r=0,c={};function l(e){var t=e.data("__uid");return t||e.data("__uid",t=""+ ++r),t}function f(e){var t,o,r,c=e[0],l=c.getBoundingClientRect(),f={offsetX:"number"==typeof i.pageXOffset?i.pageXOffset:(((r=n.documentElement)||(r=a.parentNode))&&"number"==typeof r.scrollLeft?r:a).scrollLeft,offsetY:"number"==typeof i.pageYOffset?i.pageYOffset:(((r=n.documentElement)||(r=a.parentNode))&&"number"==typeof r.scrollTop?r:a).scrollTop},s=f.offsetX,d=f.offsetY,u=l.width||c.width,p=l.height||c.height,m=l.left+s,y=l.top+d,h=Math.max(n.documentElement.clientWidth,i.innerWidth||0),g=Math.max(n.documentElement.clientHeight,i.innerHeight||0);return y<=d?y+p>=d&&(o=!0):y>=d&&y<=d+g&&(o=!0),m<=s?m+u>=s&&(t=!0):m>=s&&m<=s+h&&(t=!0),t&&o}function s(){angular.forEach(c,function(e,t){var n=e.iElement,a=e.$scope;f(n)&&n.attr("src",a.lazySrc)})}function d(){var e=angular.element(this),t=l(e);e.css("opacity",1),c.hasOwnProperty(t)&&delete c[t]}return o.bind("scroll",s),o.bind("resize",s),{restrict:"A",scope:{lazySrc:"@",animateVisible:"@",animateSpeed:"@"},link:function(e,t){t.bind("load",d),e.$watch("lazySrc",function(){var n="1s";if(null!=e.animateSpeed&&(n=e.animateSpeed),f(t))e.animateVisible&&t.css({"background-color":"#fff",opacity:0,"-webkit-transition":"opacity "+n,transition:"opacity "+n}),t.attr("src",e.lazySrc);else{var a=l(t);t.css({"background-color":"#fff",opacity:0,"-webkit-transition":"opacity "+n,transition:"opacity "+n}),c[a]={iElement:t,$scope:e}}}),e.$on("$destroy",function(){t.unbind("load");var e=l(t);c.hasOwnProperty(e)&&delete c[e]})}}}]);